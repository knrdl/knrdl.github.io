<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=content-security-policy content="default-src 'none'; style-src 'self' 'unsafe-inline'; img-src 'self' https:; font-src 'self'; script-src 'unsafe-inline'"><link rel="shortcut icon" type=image/png href=/favicon.png><link rel=sitemap type=application/xml href=/sitemap.xml title=knrdlog><title>Strategies for Docker image tagging</title><meta name=description content="notes to self"><meta property="og:title" content="Strategies for Docker image tagging"><meta property="og:description" content="Each docker image has a URI-style name like domain.tld:port/directory/subdir:tag. The image name ubuntu is just a shortcut for docker.io/library/ubuntu:latest. The default tag (if omitted) is latest. Docker (or OCI) images should be built automatically in CI-Pipelines. There are multiple strategies for tagging those images:
Docker Image Tagging via Git Commit Tags:
Relevant git commits are tagged as versions, e.g. v3.2.1 The corresponding docker image gets tagged as 3.2.1. If there are multiple image flavours, maybe also 3."><meta property="og:type" content="article"><meta property="og:url" content="https://knrdl.github.io/posts/docker-image-tagging/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-06-27T00:00:00+00:00"><meta property="article:modified_time" content="2022-06-28T10:20:50+02:00"><meta name=author content="knrdl"><link rel=stylesheet href=https://knrdl.github.io/styles.min.b1eb305989f01c7be31a7a19d4ab34ca470eddd06327253c7bcf3d1c5a41d28c.css integrity="sha256-seswWYnwHHvjGnoZ1Ks0ykcO3dBjJyU8e889HFpB0ow="></head><body><header><div class=site-header><span><a href=https://knrdl.github.io/ class=site-title>knrdlog</a></span>
<span><nav class=right-menu><span class=menu-item><a href=/tags/>tags</a></span>
<span class=menu-item><a href=https://github.com/knrdl target=_blank rel="noopener noreferrer">github</a></span>
<span class=menu-item><a href=/index.xml>rss</a></span></nav></span></div><div class=separator>================================================================================================================================================================</div></header><main><article><div class=post-header><h1>Strategies for Docker image tagging</h1><time datetime=2022-06-27 class=pubdate>2022-06-27</time>
<a href=https://github.com/knrdl/knrdl.github.io/commits/main/content/posts/docker-image-tagging.md target=_blank rel="noopener noreferrer"><time datetime=2022-06-28 class=lastmod>{üìù2022-06-28}</time></a>
<span class=tags><a href=/tags/docker class=hashtag>docker</a></span></div><p>Each docker image has a URI-style name like <code>domain.tld:port/directory/subdir:tag</code>. The image name <code>ubuntu</code> is just a shortcut for <code>docker.io/library/ubuntu:latest</code>. The default tag (if omitted) is <code>latest</code>. Docker (or <abbr title="Open Container Initiative">OCI</abbr>) images should be built automatically in <abbr title="Continuous Integration">CI</abbr>-Pipelines. There are multiple strategies for tagging those images:</p><ol><li><p><strong>Docker Image Tagging via Git Commit Tags:</strong></p><ul><li>Relevant git commits are tagged as versions, e.g. <code>v3.2.1</code></li><li>The corresponding docker image gets tagged as <code>3.2.1</code>. If there are multiple image flavours, maybe also <code>3.2.1-alpine</code> or <code>v3.2.1-slim</code></li><li><a href=https://semver.org/ target=_blank rel="noopener noreferrer">Semantic Versioning</a> is also applicable: In addition to the image tag <code>3.2.1</code>, the tags <code>3.2</code> and <code>3</code> should also be assigned, if <code>3.2.1</code> is the newest version for both version series.</li><li>The image created from the newest git commit tag (the newest version) must also be tagged as <code>latest</code></li><li>Docker images without associated git commit tag can be tagged as <code>edge</code> (convention) or something like <code>unstable</code>, <code>nightly</code> etc.</li></ul></li><li><p><strong>Docker Image Tagging via Git Commit Hash:</strong></p><ul><li>If there are no distinguishable software versions, the first 6 letters of the git commit hash (SHA) can be used to tag an image.</li><li>The <code>latest</code> tag gets assigned manually to a docker image.</li><li>Pro: It&rsquo;s easy to find the belonging image for a git commit. So an old version can easily be deployed if the newer one fails. Therefore, you must know which commit introduced the problem.</li><li>Contra:<ul><li>Produces many tagged images => Docker Image Tag Deletion Policy must be enforced</li><li>Tags will only be sortable by their creation date (might be wrong in case of manual intervention)</li><li>It&rsquo;s hard to know which tags bring in small or big changes (missing
<a href=https://semver.org/ target=_blank rel="noopener noreferrer">semantic versioning</a>)</li></ul></li><li>Strategy is only useful if there is no software versioning scheme in place and also git push&rsquo;s to the main branch are not too frequent.</li></ul></li><li><p><strong>Docker Image Tagging for the Bleeding Edge:</strong></p><ul><li>There is not dedicated tagging at all</li><li>The newest commit gets tagged as <code>latest</code></li><li>Move fast and break things</li><li>To reproduce old versions the old image must be built again (make sure to pin the versions of all dependencies your software needs). Alternatively important old versions can be tagged manually.</li></ul></li><li><p><strong>Docker Image Tagging with Timestamps:</strong></p><ul><li>Each docker image tag is a timestamp of the build date.</li><li>The last run build is tagged as <code>latest</code></li><li>Problematic if old versions are built via CI-Pipelines at a later time</li><li>Useful for nightly builds only. Produce tags like <code>nightly-YYYYMMDD</code></li></ul></li></ol><p>Which strategy is right for me? It depends! Maybe a combination &mldr;</p><hr><h3 id=tldr--opinion class=paragraph-header>TL;DR / Opinion <a href=#tldr--opinion></a></h3><ul><li><strong>Use git tags for software versioning</strong><ul><li>If the newest git tag is <code>v3.2.1</code>, the built docker image should be tagged as <code>3.2.1</code>, <code>3.2</code> and <code>3</code>.</li><li>The newest software version (by git tag) additionally gets tagged as <code>latest</code></li></ul></li><li>Building a docker image from a git commit without tag, the resulting docker image should be tagged as <code>edge</code></li></ul><div class=comments><a href="https://github.com/knrdl/knrdl.github.io/issues/new?title=Strategies+for+Docker+image+tagging" target=_blank rel="noopener noreferrer"><img src=https://knrdl.github.io/github.png alt="Github logo" style=filter:invert(.7) width=17 height=17>
<span>Feedback</span></a></div></article></main><hr><footer>Licensed under <a href=https://creativecommons.org/publicdomain/zero/1.0/ target=_blank rel='noopener norefferer'>CC0 1.0</a> |
<a href=https://gohugo.io target=_blank rel='noopener norefferer'>Hugo</a> theme inspired by <a href=https://github.com/vamc19 target=_blank rel='noopener norefferer'>vamc19</a> |
Hosted by <a href=https://pages.github.com target=_blank rel='noopener norefferer'>Github</a> (<a href=https://github.com/site/privacy target=_blank rel='noopener norefferer'>Privacy Policy</a>)</footer></body></html>