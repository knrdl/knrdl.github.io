<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=content-security-policy content="default-src 'none'; style-src 'self' 'unsafe-inline'; img-src 'self' https:; font-src 'self'; script-src 'unsafe-inline'"><link rel="shortcut icon" type=image/png href=/favicon.png><link rel=sitemap type=application/xml href=/sitemap.xml title=knrdlog><title>How to make your program generate pdf files</title><meta name=description content="notes to self"><meta property="og:title" content="How to make your program generate pdf files"><meta property="og:description" content="PDF files are still highly popular. The user will find all information in a single, human-readable file which is quite durable. However, the programmatic generation of pdf files can be a bit tricky. A rendering engine is needed to transform the source data into the target pdf file. The source data can be broken up into two parts: templates and dynamic data. The template is a skeleton of the pdf document."><meta property="og:type" content="article"><meta property="og:url" content="https://knrdl.github.io/posts/pdf-rendering/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-05T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-05T19:53:43+02:00"><meta name=author content="knrdl"><link rel=stylesheet href=https://knrdl.github.io/styles.min.a31357fe73c92b84f5afc348cdfd6a2aae125ca026214c2bfbf283859671b0e7.css integrity="sha256-oxNX/nPJK4T1r8NIzf1qKq4SXKAmIUwr+/KDhZZxsOc="></head><body><header><div class=site-header><span><a href=https://knrdl.github.io/ class=site-title>knrdlog</a></span>
<span><nav class=right-menu><span class=menu-item><a href=/tags/>tags</a></span>
<span class=menu-item><a href=https://github.com/knrdl target=_blank rel="noopener noreferrer">github</a></span>
<span class=menu-item><a href=/index.xml>rss</a></span></nav></span></div><div class=separator>================================================================================================================================================================</div></header><main><article><div class=post-header><h1>How to make your program generate pdf files</h1><time datetime=2022-08-05 class=pubdate>2022-08-05</time>
<span class=tags><a href=/tags/latex class=hashtag>latex</a>
<a href=/tags/pdf class=hashtag>pdf</a>
<a href=/tags/webdev class=hashtag>webdev</a></span></div><p>PDF files are still highly popular. The user will find all information in a single, human-readable file which is quite durable.
However, the programmatic generation of pdf files can be a bit tricky. A rendering engine is needed to transform the source data into the target pdf file. The source data can be broken up into two parts: templates and dynamic data. The template is a skeleton of the pdf document. It contains static texts, images, styling and positioning rules etc. It also contains field definitions where the dynamic data will be filled in. The process of merging template and dynamic data is done by a templating engine.</p><p>There are multiple technologies applicable.</p><h2 id=office-suites class=paragraph-header>Office Suites <a href=#office-suites></a></h2><p>It&rsquo;s pretty easy to generate a pdf file by using an office suite like LibreOffice or Google Docs. It&rsquo;s even possible to automate this with a headless LibreOffice instance. But working with
<a href=https://de.wikipedia.org/wiki/OpenDocument target=_blank rel="noopener noreferrer">OpenDocument</a> files as templates for the pdf creation is not developer friendly (e.g. no git diffs &mldr;). The implementation will be extra hard if the dynamic data also include complicated stuff like styling directives. On the other hand templates might be maintained in a WYSIWYG manner with user know software (basically just the office suite).</p><h2 id=programmatic-drawing class=paragraph-header>Programmatic drawing <a href=#programmatic-drawing></a></h2><p>Drawing and writing elements programmatically on the pdf canvas is a pragmatic approach. The template is just a regular pdf file with some blanks. While this approach definitely works for simple documents, it gets harder with increasing document complexity. For example necessary line breaks and text alignments are easy to get wrong. In the long run a more sophisticated approach will be easier to handle.</p><h2 id=latex class=paragraph-header>Latex <a href=#latex></a></h2><p>Latex is an extremely powerful and function-rich text processor which can also generate pdf files, of course. Using latex files as templates is also pretty easy because it is just text containing latex rules. The maintainers of the templates must be able to work with latex files, which could be quite a restriction. They need to learn latex first.</p><blockquote><p class=warning>The dynamic input is arbitrary data. To prevent <strong>Latex Injections</strong> the templating engine must escape all dynamic input. Otherwise, an attacker might tamper the generated pdf file or even execute commands on your server (e.g. when the latex flag <code>-shell-escape</code> is set)!</p></blockquote><p>PDF generation using latex is a solid and well-tested approach.</p><h2 id=webbrowsers class=paragraph-header>Webbrowsers <a href=#webbrowsers></a></h2><p>Webbrowsers can render the DOM (web content) of a webpage to a pdf file. This function is regularly exposed in the user interface. It&rsquo;s also available via JavaScript as e.g. <code>window.print()</code>. However, this is still manual and based on user interaction.</p><p>But a headless browser engine (typically firefox or chromium) can also be executed in the backend. An adapter, called webdriver, is needed to control such an instance, e.g. Selenium, PhantomJs (deprecated) or Puppeteer. Now it&rsquo;s possible to get a pdf via the webdriver out of the headless browser. Keep in mind that it takes some time to spin up a browser instance, fully load and render the webpage and then generate the pdf.</p><p>This approach is really developer (especially web-developer) friendly. Templates might be maintained via a WYSIWYG webpage editor.</p><p>Problematic is the potentially high resource usage of a browser engine. Running too many parallel rendering jobs at the same time can eat up the servers resources. To prevent this a job queue should be used in conjunction with a limited number of parallel executors.</p><h2 id=pseudo-webbrowsers class=paragraph-header>Pseudo Webbrowsers <a href=#pseudo-webbrowsers></a></h2><p>Full-featured browser engines like firefox and chromium are powerful but (relatively) slow. There are engines which only implement a subset of the web standards (e.g. only HTML4 with some CSS3 rules) but have a significant higher throughput and less resource usage. Examples are
<a href=https://weasyprint.org/ target=_blank rel="noopener noreferrer">WeasyPrint</a> and
<a href=https://xhtml2pdf.readthedocs.io/ target=_blank rel="noopener noreferrer">xhtml2pdf</a>. The downside of this approach is that due to the non-standard conforming behaviour each engine interprets the html and css rules differently. So the templates will not be portable. It might also be difficult to figure out how the engine actually interprets positioning and styling rules.</p><div class=comments><a href="https://github.com/knrdl/knrdl.github.io/issues/new?title=How+to+make+your+program+generate+pdf+files" target=_blank rel="noopener noreferrer"><img src=https://knrdl.github.io/github.png alt="Github logo" style=filter:invert(.7) width=17 height=17>
<span>Feedback</span></a></div></article></main><hr><footer>Licensed under <a href=https://creativecommons.org/publicdomain/zero/1.0/ target=_blank rel='noopener norefferer'>CC0 1.0</a> |
<a href=https://gohugo.io target=_blank rel='noopener norefferer'>Hugo</a> theme inspired by <a href=https://github.com/vamc19 target=_blank rel='noopener norefferer'>vamc19</a> |
Hosted by <a href=https://pages.github.com target=_blank rel='noopener norefferer'>Github</a> (<a href=https://github.com/site/privacy target=_blank rel='noopener norefferer'>Privacy Policy</a>)</footer></body></html>